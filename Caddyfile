# 1. The root domain
# This handles the actual traffic and federation
your-domain.com {
	handle_path /.well-known/matrix/* {
		header Access-Control-Allow-Origin *
        header Content-Type application/json
        header Cache-Control public,max-age=806400
		respond /client `{"m.homeserver": {"base_url":"https://matrix.your-domain.com"}}`
		respond /server `{"m.server":"matrix.your-domain.com:443"}`
		respond 404
    }
}

# 2. The matrix subdomain
matrix.your-domain.com {
	reverse_proxy continuwuity:6167
}
